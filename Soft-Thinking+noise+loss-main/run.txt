#!/bin/bash
#PBS -P CFP01-SF-001
#PBS -j oe
#PBS -k oed
#PBS -N CoLaR-uphill
#PBS -q auto
#PBS -l select=1:ngpus=1
#PBS -l walltime=2:00:01

cd $PBS_O_WORKDIR;
bash << EOF > stdout.$PBS_JOBID 2> stderr.$PBS_JOBID
source /scratch/e1374322/miniconda3/etc/profile.d/conda.sh
conda activate soft_thinking
python run_sglang_softthinking.py \
    --dataset "aime2024" \
    --model_name "/scratch/e1374322/meta-llama/DeepSeek-R1-Distill-Qwen-1.5B" \
    --max_topk 5 \
    --max_generated_tokens 32768 \
    --temperature 0.6 \
    --top_p 0.95 \
    --top_k 30 \
    --min_p 0.0 \
    --after_thinking_temperature 0.6 \
    --after_thinking_top_p 0.95 \
    --after_thinking_top_k 30 \
    --after_thinking_min_p 0.0 \
    --mem_fraction_static 0.8 \
    --start_idx 0 \
    --end_idx 10000 \
    --num_gpus 1 \
    --num_samples 16 \
    --enable_soft_thinking \
    --add_noise_gumbel_softmax \
    --gumbel_softmax_temperature 0.5 

EOF